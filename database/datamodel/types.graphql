type User {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!

  # Info
  auth0Id: String! @unique
  username: String! @unique
  email: String! @unique
  email_verified: String

  # Meta
  name: String
  gender: Gender!
  description: String
  url: String
  picture: File! @relation(name: "UserPicture")
  video: File @relation(name: "UserVideo")
  # isTeacher: Boolean

  # Stripe
  stripeId: String @unique
  stripeCustomerId: String @unique

  # classes: [Class!]! @relation(name: "UserClasses")
  # taughtClasses: [Class!]! @relation(name: "UserTaughtClasses")
  taught_classrooms: [Classroom!]! @relation(name: "ClassroomTeacher")
  studying_classrooms: [Classroom!]! @relation(name: "ClassroomStudent")

  followers: [Follow!]! @relation(name: "UserFollowed")
  following: [Follow!]! @relation(name: "UserFollowing")
  # activities: [Activity!]! @relation(name: "UserActivities")
  messages: [Message!]! @relation(name: "UserMessages")
  charges: [Charge!]! @relation(name: "UserCharges")
  refunds: [Refund!]! @relation(name: "UserRefunds")
}

type Follow {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!

  user_following: User! @relation(name: "UserFollowing")
  user_followed: User! @relation(name: "UserFollowed")
}

type Classroom {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!

  name: String!
  description: String!
  price: Float! @deafult(value: "0")
  classes: [Class!]! @relation(name: "ClassroomClass")

  teacher: User! @relation(name: "ClassroomTeacher")
  students: [User!]! @relation(name: "ClassroomStudent")
}

type Class {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!

  # Info
  name: String!
  description: String!
  picture: String # TODO: move to file
  price: Float! @default(value: "0")
  startDate: DateTime

  # Stream
  live: Boolean! @default(value: "false")
  duration: Int # in minutes
  video: File @relation(name: "ClassVideo")

  # Specs
  # teachers: [User!]! @relation(name: "UserTaughtClasses")
  # students: [User!]! @relation(name: "UserClasses")
  # studentsCount: Int
  files: [File!]! @relation(name: "ClassFiles")
  vods: [File!]! @relation(name: "ClassVods")
  classroom: Classroom! @relation(name: "ClassroomClass")
  messages: [Message!]! @relation(name: "ClassMessages")
  # activities: [Activity!]! @relation(name: "ClassActivities")
  # charges: [Charge!]! @relation(name: "ClassCharges")
  # refunds: [Refund!]! @relation(name: "ClassRefunds")
}

type File {
  id: ID! @unique
  name: String!
  secret: String @unique
  contentType: String
  createdAt: DateTime!
  updatedAt: DateTime!
  url: String! @unique
  # TODO: this can all be deleted - one way bindings
  # user: User @relation(name: "UserVideo")
  # userPicture: User @relation(name: "UserPicture")
  # class: Class @relation(name: "ClassFiles")
  # classVod: Class @relation(name: "ClassVods")
  # classVideo: Class @relation(name: "ClassVideo")
}

type Message {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!

  text: String!
  sender: User! @relation(name: "UserMessages")
  class: Class! @relation(name: "ClassMessages")
}

type Charge {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!

  amount: Float!
  stripeId: String! @unique

  class: Class! @relation(name: "ClassCharges")
  user: User! @relation(name: "UserCharges")

  refund: Refund @relation(name: "ChargeRefund")
}

type Refund {
  id: ID! @unique
  createdAt: DateTime!
  updatedAt: DateTime!

  stripeId: String! @unique
  amount: Float!
  # TODO: some of this can be omitted
  charge: Charge! @relation(name: "ChargeRefund")
  class: Class! @relation(name: "ClassRefunds")
  user: User! @relation(name: "UserRefunds")
}

#
# type Activity {
#   text: String!
#   user: User! @relation(name: "UserActivities")
#   classroom: Classroom! @relation(name: "ClassroomActivities")
#   class: Class! @relation(name: "ClassActivities")
# }
